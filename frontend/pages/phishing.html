<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RakshaNetra | Phishing Detection</title>

  <script src="https://cdn.tailwindcss.com?plugins=forms"></script>

  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@100..700&display=swap" rel="stylesheet">

  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            primary: "#0dccf2",
            bgDark: "#101f22",
            surface: "#111718",
            borderDark: "#283639",
          },
          fontFamily: {
            display: ["Space Grotesk", "sans-serif"],
          },
        },
      },
    };
  </script>

  <style>
    body { font-family: "Space Grotesk", sans-serif; }
  </style>
</head>

<body class="bg-bgDark text-white font-display">

<main class="ml-64 p-8 space-y-10">

  <div class="max-w-4xl mx-auto text-center">
    <h1 class="text-4xl font-black mb-4">Phishing Detection Tool</h1>
    <p class="text-slate-400 text-lg">
      Detect phishing attempts using rule-based cybersecurity logic.
    </p>
  </div>

  <div class="max-w-4xl mx-auto bg-surface border border-borderDark rounded-xl p-6 space-y-4">
    <h3 class="text-lg font-bold flex items-center gap-2">
      <span class="material-symbols-outlined text-primary">text_fields</span>
      Paste Message Content
    </h3>

    <textarea
      id="phishingText"
      rows="7"
      placeholder="Paste email, SMS, or message here..."
      class="w-full bg-bgDark border border-borderDark rounded-lg px-4 py-3 focus:border-primary outline-none text-sm"
    ></textarea>

    <div class="flex justify-center pt-4">
      <button
        onclick="checkPhishing()"
        class="px-8 py-3 bg-primary text-black font-bold rounded-lg hover:opacity-90 transition"
      >
        Analyze Message
      </button>
    </div>
  </div>

  <div
    id="phishingResult"
    class="max-w-4xl mx-auto mt-6 p-5 rounded-lg text-sm hidden"
  ></div>

</main>

<script>
async function checkPhishing() {
    const text = document.getElementById("phishingText").value.trim();
    const resultDiv = document.getElementById("phishingResult");

    if (!text) {
        alert("Please paste a message first");
        return;
    }

    resultDiv.classList.remove("hidden");
    resultDiv.className =
        "max-w-4xl mx-auto mt-6 p-5 rounded-lg text-sm bg-slate-800 text-slate-200";
    resultDiv.innerHTML = "üîç Analyzing message...";

    try {
        const response = await fetch(
            "http://127.0.0.1:5000/api/check-phishing",
            {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ text })
            }
        );

        const data = await response.json();

        let color =
            "bg-green-900/30 text-green-300 border border-green-700";
        if (data.risk === "MEDIUM")
            color = "bg-yellow-900/30 text-yellow-300 border border-yellow-700";
        if (data.risk === "HIGH")
            color = "bg-red-900/30 text-red-300 border border-red-700";

        resultDiv.className =
            `max-w-4xl mx-auto mt-6 p-5 rounded-lg text-sm ${color}`;

        resultDiv.innerHTML = `
          <b>Status:</b> ${data.status}<br>
          <b>Risk Level:</b> ${data.risk}<br>
          <b>Score:</b> ${data.score}/100<br><br>
          <b>Reasons:</b><br>
          ${data.reasons.length ? data.reasons.join("<br>") : "No suspicious indicators found"}
        `;
    } catch (err) {
        resultDiv.className =
            "max-w-4xl mx-auto mt-6 p-5 rounded-lg text-sm bg-red-900/30 text-red-300 border border-red-700";
        resultDiv.innerHTML =
            "‚ùå Backend not reachable. Is Flask running?";
    }
}
</script>

</body>
</html>
